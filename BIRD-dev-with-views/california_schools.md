4 views

```sql
CREATE VIEW vw_schools_directory AS
SELECT
CDSCode,
NCESDist,
NCESSchool,
StatusType,
County,
District,
School,
Street,
StreetAbr,
City,
Zip,
State,
MailStreet,
MailStrAbr,
MailCity,
MailZip,
MailState,
Phone,
Ext,
Website,
OpenDate,
ClosedDate,
Charter,
CharterNum,
FundingType,
DOC,
DOCType,
SOC,
SOCType,
EdOpsCode,
EdOpsName,
EILCode,
EILName,
GSoffered,
GSserved,
Virtual,
Magnet,
Latitude,
Longitude,
AdmFName1,
AdmLName1,
AdmEmail1,
AdmFName2,
AdmLName2,
AdmEmail2,
AdmFName3,
AdmLName3,
AdmEmail3,
LastUpdate
FROM schools;

CREATE VIEW vw_frpm_enriched AS
SELECT
f.CDSCode,
s.County,
s.District,
s.School,
s.StatusType,
s.Charter,
s.CharterNum,
s.FundingType,
s.DOC,
s.DOCType,
s.SOC,
s.SOCType,
s.EdOpsCode,
s.EdOpsName,
s.EILCode,
s.EILName,
s.GSoffered,
s.GSserved,
s.Virtual,
s.Magnet,
s.Latitude,
s.Longitude,
f."Academic Year",
f."County Code",
f."District Code",
f."School Code",
f."County Name",
f."District Name",
f."School Name",
f."District Type",
f."School Type",
f."Educational Option Type",
f."NSLP Provision Status",
f."Charter School (Y/N)",
f."Charter School Number",
f."Charter Funding Type",
f.IRC,
f."Low Grade",
f."High Grade",
f."Enrollment (K-12)",
f."Free Meal Count (K-12)",
f."Percent (%) Eligible Free (K-12)",
f."FRPM Count (K-12)",
f."Percent (%) Eligible FRPM (K-12)",
f."Enrollment (Ages 5-17)",
f."Free Meal Count (Ages 5-17)",
f."Percent (%) Eligible Free (Ages 5-17)",
f."FRPM Count (Ages 5-17)",
f."Percent (%) Eligible FRPM (Ages 5-17)",
f."2013-14 CALPADS Fall 1 Certification Status"
FROM frpm f
LEFT JOIN schools s ON s.CDSCode = f.CDSCode;

CREATE VIEW vw_satscores_enriched AS
SELECT
t.cds,
t.rtype,
t.sname,
t.dname,
t.cname,
t.enroll12,
t.NumTstTakr,
t.AvgScrRead,
t.AvgScrMath,
t.AvgScrWrite,
t.NumGE1500,
CASE WHEN t.enroll12 > 0 THEN 1.0 * t.NumTstTakr / t.enroll12 END AS "SAT Participation Rate",
CASE WHEN t.NumTstTakr > 0 THEN 1.0 * t.NumGE1500 / t.NumTstTakr END AS "SAT Excellence Rate (GE1500)",
CASE
WHEN t.AvgScrRead IS NOT NULL AND t.AvgScrMath IS NOT NULL AND t.AvgScrWrite IS NOT NULL
THEN (t.AvgScrRead + t.AvgScrMath + t.AvgScrWrite)
END AS "Avg Total SAT Score",
s.CDSCode,
s.StatusType,
s.County,
s.District,
s.School,
s.Charter,
s.Magnet,
s.GSserved,
s.EILName
FROM satscores t
LEFT JOIN schools s ON s.CDSCode = t.cds;

CREATE VIEW vw_k12_combined AS
SELECT
s.CDSCode,
s.StatusType,
s.County,
s.District,
s.School,
s.Street,
s.City,
s.Zip,
s.State,
s.Phone,
s.Website,
s.OpenDate,
s.ClosedDate,
s.Charter,
s.CharterNum,
s.FundingType,
s.DOC,
s.DOCType,
s.SOC,
s.SOCType,
s.EdOpsCode,
s.EdOpsName,
s.EILCode,
s.EILName,
s.GSoffered,
s.GSserved,
s.Virtual,
s.Magnet,
s.Latitude,
s.Longitude,
f."Academic Year",
f."County Code",
f."District Code",
f."School Code",
f."County Name",
f."District Name",
f."School Name",
f."District Type",
f."School Type",
f."Educational Option Type",
f."NSLP Provision Status",
f."Charter School (Y/N)",
f."Charter School Number",
f."Charter Funding Type",
f.IRC,
f."Low Grade",
f."High Grade",
f."Enrollment (K-12)",
f."Free Meal Count (K-12)",
f."Percent (%) Eligible Free (K-12)",
f."FRPM Count (K-12)",
f."Percent (%) Eligible FRPM (K-12)",
f."Enrollment (Ages 5-17)",
f."Free Meal Count (Ages 5-17)",
f."Percent (%) Eligible Free (Ages 5-17)",
f."FRPM Count (Ages 5-17)",
f."Percent (%) Eligible FRPM (Ages 5-17)",
f."2013-14 CALPADS Fall 1 Certification Status",
t.cds,
t.rtype,
t.sname,
t.dname,
t.cname,
t.enroll12,
t.NumTstTakr,
t.AvgScrRead,
t.AvgScrMath,
t.AvgScrWrite,
t.NumGE1500,
CASE WHEN t.enroll12 > 0 THEN 1.0 * t.NumTstTakr / t.enroll12 END AS "SAT Participation Rate",
CASE WHEN t.NumTstTakr > 0 THEN 1.0 * t.NumGE1500 / t.NumTstTakr END AS "SAT Excellence Rate (GE1500)",
CASE
WHEN t.AvgScrRead IS NOT NULL AND t.AvgScrMath IS NOT NULL AND t.AvgScrWrite IS NOT NULL
THEN (t.AvgScrRead + t.AvgScrMath + t.AvgScrWrite)
END AS "Avg Total SAT Score"
FROM schools s
LEFT JOIN frpm f ON f.CDSCode = s.CDSCode
LEFT JOIN satscores t ON t.cds = s.CDSCode;
```
